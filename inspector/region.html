<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8"/>
        <title>Habitat Inspector</title>
        <link rel="stylesheet" href="style.css">
        <script type="importmap">
            {
                "imports": {
                    "htm": "./vendor/htm.mjs",
                    "preact": "./vendor/preact.mjs",
                    "preact/hooks": "./vendor/hooks.mjs",
                    "@preact/signals-core": "./vendor/signals-core.mjs",
                    "@preact/signals": "./vendor/signals.mjs"
                }
            }
        </script>
        <script type="module">
            // import "https://esm.sh/preact/debug"
            import { render } from "preact"
            import { html, errors } from "./view.js"
            import { useHabitatJson } from "./data.js"
            import { regionView, regionNav, objectDetails } from "./region.js"

            const q = new URLSearchParams(window.location.search)
            const filename = q.get("f") ?? "db/new_Downtown/Downtown_4d.json"

            const regionName = ({ filename }) => {
                const objects = useHabitatJson(filename, [])
                const region = objects.find(obj => obj.type == "context")
                return html`<span>${(region && region.name) ?? filename}</span>`
            }

            render(html`
                <h1>Region - <${regionName} filename=${filename}/></h1>
                <${regionView} filename=${filename}/>
                <div>
                    <h2>Neighboring regions</h2>
                    <${regionNav} filename=${filename}/>
                </div>
                <div>
                    <h2>Objects</h2>
                    <${objectDetails} filename=${filename}/>
                </div>
                <${errors}/>
            `, document.getElementById("regionview"))
        </script>
    </head>
    <body>
        <div id="regionview">
        </div>
        <a href="index.html">Home</a>
    </body>
</html>